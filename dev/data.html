<!DOCTYPE html>
<html lang="ja">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />

    <title>routeDB</title>
</head>

<body onload="init()">
    <script>
        const getCompany = async() => {
            const url = `https://routedb.github.io/dev/data/tmp_company.json`;
            const response = await fetch(url, {
                method: "get"
            });
            const json = response.json()
            if (response.status == 200) {
                return Promise.resolve(json);
            } else {
                return Promise.reject(json.error);
            }
        };
        const getLine = async(company) => {
            const url = `https://api.ekispert.jp/v1/json/rail?key=5F6YFMvV7wS2CSFP&corporationName=${company}`;
            const response = await fetch(url, {
                method: "get"
            });
            const json = response.json()
            if (response.status == 200) {
                return Promise.resolve(json);
            } else {
                return Promise.reject(json.error);
            }
        };


        function init() {
            getCompany()
                .then((data) => {
                    console.log(data);
                    let out = "";
                    for (let idx in data) {
                        console.log(getLine(data[idx]));
                    }
                    document.getElementById("list").innerHTML = out;
                })
                .catch((err) => {
                    console.log(err);
                });
        }
    </script>
</body>